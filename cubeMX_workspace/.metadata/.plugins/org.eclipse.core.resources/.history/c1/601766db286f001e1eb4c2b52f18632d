
/* USER CODE BEGIN Includes */
#include "stm32f3xx_hal.h" 	// usually it's already included in main.h
#include <stdbool.h>
/* USER CODE END Includes */

/* USER CODE BEGIN PV */

//defining BTN states
uint16_t BTN_initState = GPIO_PIN_SET; //in case if GPIO default level HI (use pull-up resistor)
uint16_t BTN_currentState;
uint16_t BTN_press_slowCount = 0;
uint16_t BTN_release_slowCount = 0;
bool BTN_isPressed = false;

//defining debounce time window
int BTN_DEBOUNCE_TIMER = 20;

//defining handler for your timer (this example for exmpl TIM16)
TIM_HandleTypeDef htim16;

/* HAL_TIM_Base_Start_IT(&htim16); */ //!!!!!!!add this line into a MX_TIM16_Init function!!!!!!!

/* USER CODE END PV */


/* USER CODE BEGIN 4 */
//TIM interrupt processing
void HAL_TIM_PeriodElapsedCallback (TIM_HandleTypeDef * htim)
{

	if(htim == &htim16) //cheking if interrupt came from our TIM
	{
		BTN_currentState = HAL_GPIO_ReadPin(GPIOB, BTN_Pin);

		//onCLICK code
		if(BTN_currentState != BTN_initState)
		{
			++BTN_press_slowCount;

			if(BTN_press_slowCount > BTN_DEBOUNCE_TIMER)
			{
				//if you are here than BTN is pressed
				BTN_press_slowCount = 0;

				if(BTN_isPressed == false)
				{

					/* ONCLICK YOUR CODE HERE */

					BTN_isPressed = true;
				}
			}

		}
		//onRELEASE code
		if(BTN_currentState == BTN_initState && BTN_isPressed == true)
		{

			++BTN_release_slowCount;

			if(BTN_release_slowCount > BTN_DEBOUNCE_TIMER)
			{

				BTN_isPressed = false;
				BTN_release_slowCount = 0;

				/* ONRELEASE YOUR CODE HERE */

			}
		}

	}
}
/* USER CODE BEGIN 4 */
